---
layout:     post
title:      "DSO代码阅读"
subtitle:   " \"博学之审问之慎思之明辨之笃行之。\""
date:       2017-2-28 22：19
author:     "Bobin"
tags:
    - DSO
---


最近再看OSO的代码，这里总结一下。
EFFrame其中的EF表示的是Energy Function，类似的是EFPoint。这两个类分别被FrameHessian和PointHessian调用。
AffLight表示光度模型和曝光量的两个参数a，曝光量。b光度学模型的偏置。
trackNewCoarse 中关心的内容是三帧分别是slast、sprelast、lastF。lastF表示最近的参考帧coarseTracker->lastRef。slast、sprelast表示allFrameHistory中的最新的两帧图像。

1. allFrameHistory的构造，他是在addActiveFrame中添加的，先构造空的结构，然后把图像数据丢进去，使用makeImage函数。
2. makeImages 构造dI，梯度图像。
3. coarseTracker->lastRef在coarseTracker类的成员函数setCoarseTrackingRef中设置，frameHessians.back出一帧。frameHessians在makeKeyFrame中pushback。
poseValid


## Tracking new coarse
该函数被makeKeyFrame和makeNonKeyFrame被调用。两者在mappingLoop和makeNonKeyFrame中分情况对立出现。
该函数的主要内容是
1. push many tries
2. for every tries, do
  - 计算他们的res cur and old Res
  - calc gs sse
  - ???

## dilver tracker frame
1. display image
2. make key frame

### make kf
函数|目的
--|--
1. trace new coarse | 运动量估计
2. flag frame for marginalization |
3. add frame to Struct
4. add new residuals for old points
5. active point in marginalization
6. optimization
7. remove outliers
8. get nulll space
9. marginalize points

## marginalize frame
1. ef-> marginalize frame
  -
2. for every frame in our the buffer
  - for evert points in the frame
    - get residuals
    - statistics_numForceDroppedResFwd
    - ef->dropResidual(r->efResidual);
    -
